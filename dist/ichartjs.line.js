(function(b){b.LineSegment=b.extend(b.Component,{configure:function(){b.LineSegment.superclass.configure.apply(this,arguments);this.type="linesegment";this.set({brushsize:1,intersection:!0,label:{},sign:"round",hollow:!0,hollow_inside:!0,hollow_color:"#FEFEFE",smooth:!1,smoothing:1.5,point_size:6,points:[],keep_with_coordinate:!1,shadow_blur:1,shadow_offsety:1,point_space:0,coordinate:null,event_range_x:0,limit_y:!1,tip_offset:2,event_range_y:0});this.registerEvent("parseText");this.tip=null;this.ignored_=!1},drawSegment:function(){var a=this._(),b=a.get("points"),e=a.get("f_color"),f=a.get("brushsize");a.get("area")&&a.T.polygon(a.get("light_color2"),!1,1,"",!1,a.get("area_opacity"),a.get("smooth")?b:[{x:a.x,y:a.y}].concat(b.concat([{x:a.x+a.get(a.W),y:a.y}])),a.get("smooth"),a.get("smoothing"),[{x:a.x,y:a.y},{x:a.x+a.get(a.W),y:a.y}]);a.T.shadowOn(a.get("shadow"));a.T[a.ignored_?"manyLine":"lineArray"](b,f,e,a.get("smooth"),a.get("smoothing"));if(a.get("intersection")){var g=a.getPlugin("sign"),j=a.get("point_size"),d=a.get("hollow_color");a.get("hollow_inside")&&(d=e,e=a.get("hollow_color"));b.each(function(b){if(!b.ignored&&(!g||!g.call(a,a.T,a.get("sign"),b.x,b.y,j,e,d)))a.get("hollow")?a.T.round(b.x,b.y,j/2-f,e,f+1,d):a.T.round(b.x,b.y,j/2,e)},a)}a.get("shadow")&&a.T.shadowOff()},doDraw:function(a){a.drawSegment();a.get("label")&&a.labels.each(function(a){a.draw()})},isEventValid:function(){return{valid:!1}},tipInvoke:function(){var a=this.x,b=this.get("tip_offset"),e=this.get("point_size")+b,f=this;return function(g,j,d){var h=d.left,d=d.top,h=3>f.tipPosition&&0<h-g-a-b||2<f.tipPosition&&0>h-g-a-b?h-(g+b):h+b,d=0==f.tipPosition%2?d+e:d-j-e;return{left:h,top:d}}},doConfig:function(){b.LineSegment.superclass.doConfig.call(this);b.Assert.gt(this.get("point_space"),0,"point_space");var a=this._(),k=!!a.get("label"),e=3*a.get("point_size")/2,f=a.get("point_space"),g=a.get("event_range_y"),j=a.get("event_range_x"),d=a.get("tipInvokeHeap"),h=a.get("points"),l=a.get("name");a.labels=[];h.each(function(m){m.x_=m.x;m.y_=m.y;m.ignored&&(a.ignored_=!0);!m.ignored&&k&&(a.push("label.originx",m.x),a.push("label.originy",m.y-e),a.push("label.text",a.fireString(a,"parseText",[a,m.value],m.value)),b.applyIf(a.get("label"),{textBaseline:"bottom",color:a.get("f_color")}),a.labels.push(new b.Text(a.get("label"),a)))});if(0>=j||j>f/2)j=a.push("event_range_x",f/2);0==g&&(g=a.push("event_range_y",e/2));a.get("tip.enable")&&(a.on("mouseover",function(){d.push(a);a.tipPosition=d.length}).on("mouseout",function(){d.pop()}),a.push("tip.invokeOffsetDynamic",!0),a.tip=new b.Tip(a.get("tip"),a));var n=a.get("coordinate"),c=a.get("limit_y"),i=a.get("keep_with_coordinate"),o=function(a,b,d){return!a.ignored&&Math.abs(b-a.x)<j&&(!c||c&&Math.abs(d-a.y)<g)?true:false},p=function(a){return{valid:true,name:l,value:h[a].value,text:h[a].text,top:h[a].y,left:h[a].x,i:a,hit:true}};a.isEventValid=function(c){if(n&&!n.isEventValid(c,n).valid)return{valid:false};var d=Math.floor((c.x-a.x)/f);if(d<0||d>=h.length-1){d=b.between(0,h.length-1,d);return o(h[d],c.x,c.y)?p(d):{valid:i}}for(var e=d;e<=d+1;e++)if(o(h[e],c.x,c.y))return p(e);return{valid:i}}}});b.Line=b.extend(b.Chart,{configure:function(){b.Line.superclass.configure.call(this);this.type="line";this.set({brushsize:1,coordinate:{axis:{width:[0,0,2,2]}},crosshair:{enable:!1},tipMocker:null,tipMockerOffset:null,scaleAlign:"left",labelAlign:"bottom",labels:[],label_space:6,proportional_spacing:!0,label_spacing:0,sub_option:{},legend:{sign:"bar"},label:{}});this.registerEvent("parsePoint")},getCoordinate:function(){return this.coo},doConfig:function(){b.Line.superclass.doConfig.call(this);var a=this._(),k=1==a.data.length;b.Coordinate.coordinate.call(a);var e=a.get("coordinate.valid_width"),f=a.get("coordinate.valid_height");a.lines=[];a.lines.zIndex=a.get("z_index");a.components.push(a.lines);a.get("proportional_spacing")&&a.push("label_spacing",e/(a.get("maxItemSize")-1));a.push("sub_option.width",e);a.push("sub_option.height",f);a.pushIf("sub_option.keep_with_coordinate",k);a.get("crosshair.enable")&&(a.push("coordinate.crosshair",a.get("crosshair")),a.push("coordinate.crosshair.hcross",k),a.push("coordinate.crosshair.invokeOffset",function(b){b=a.lines[0].isEventValid(b);return b.valid?b:!1}));a.pushIf("coordinate.scale",[{position:a.get("scaleAlign"),max_scale:a.get("maxValue")},{position:a.get("labelAlign"),start_scale:1,scale:1,end_scale:a.get("maxItemSize"),labels:a.get("labels"),label:a.get("label")}]);a.coo=b.Coordinate.coordinate_.call(a);a.push("sub_option.originx",a.coo.get("x_start"));a.push("sub_option.originy",a.coo.get(a.Y)+a.coo.get(a.H));a.components.push(a.coo);if(a.get("tip.enable")&&b.isFunction(a.get("tipMocker"))){a.push("sub_option.tip.enable",!1);a.push("tip.invokeOffsetDynamic",!0);var g,j=a.coo.get(a.X),d=a.coo.get(a.Y),h=a.coo.get(a.H),l=a.get("tipMockerOffset"),n,c,i,l=b.isNumber(l)?0>l?0:1<l?1:l:null;a.push("tip.invokeOffset",function(a,b,c){if(l!=null)c.top=d+(h-b)*l;else{c.top=c.maxTop-(c.maxTop-c.minTop)/3-b;if(b>h||d>c.top)c.top=d}return{left:c.left-a-j>5?c.left-a-5:c.left+5,top:c.top}});var o=a.get("tip.listeners.parseText");o&&delete a.get("tip.listeners").parseText;k=new b.Custom({eventValid:function(b){c=a.lines[0].isEventValid(b);c.hit=n!=c.i;if(c.valid){n=c.i;g=[];a.lines.each(function(a,d){i=a.isEventValid(b);if(d==0)c.minTop=c.maxTop=i.top;else{c.minTop=Math.min(c.minTop,i.top);c.maxTop=Math.max(c.maxTop,i.top)}g.push(o?o(null,i.name,i.value,i.text,i.i):i.name+" "+i.value)});c.text=a.get("tipMocker").call(a,g,c.i)||"tipMocker not return"}return c.valid?c:false}});new b.Tip(a.get("tip"),k);a.components.push(k)}b.applyIf(a.get("sub_option"),b.clone(["area_opacity"],a.options))}});b.LineBasic2D=b.extend(b.Line,{configure:function(){b.LineBasic2D.superclass.configure.call(this);this.type="basicline2d";this.tipInvokeHeap=[]},doAnimation:function(a,b,e){e.coo.draw();e.lines.each(function(f){f.get("points").each(function(g){g.y=f.y-Math.ceil(e.animationArithmetic(a,0,f.y-g.y_,b))});f.drawSegment()})},doConfig:function(){b.LineBasic2D.superclass.doConfig.call(this);var a=this._(),k=a.coo.getScale(a.get("scaleAlign")),e=a.get("coordinate.valid_height"),f=a.get("label_spacing"),g,j,d,h=a.get("sub_option.originx"),l=a.get("sub_option.originy")-k.basic*e,n;a.push("sub_option.tip.showType","follow");a.push("sub_option.coordinate",a.coo);a.push("sub_option.tipInvokeHeap",a.tipInvokeHeap);a.push("sub_option.point_space",f);a.data.each(function(c){g=[];c.value.each(function(i,o){j=f*o;d=(i-k.start)*e/k.distance;n={x:h+j,y:l-d,value:i,text:c.name+" "+i};b.merge(n,a.fireEvent(a,"parsePoint",[c,i,j,d,o]));g.push(n)},a);a.push("sub_option.name",c.name);a.push("sub_option.points",g);a.push("sub_option.brushsize",c.linewidth||c.line_width||1);a.push("sub_option.background_color",c.background_color||c.color);a.lines.push(new b.LineSegment(a.get("sub_option"),a))},this)}});b.Area2D=b.extend(b.LineBasic2D,{configure:function(){b.Area2D.superclass.configure.call(this);this.type="area2d";this.set({area_opacity:0.3})},doConfig:function(){this.push("sub_option.area",!0);b.Area2D.superclass.doConfig.call(this)}})})(iChart);