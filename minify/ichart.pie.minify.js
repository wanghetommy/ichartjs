iChart.Pie=iChart.extend(iChart.Chart,{configure:function(){iChart.Pie.superclass.configure.call(this);this.type="pie";this.set({radius:0,offset_angle:0,bound_event:"click",counterclockwise:!1,intellectLayout:!0,layout_distance:6,pop_animate:!1,mutex:!1,increment:void 0,sub_option:{label:{}}});this.registerEvent("bound","rebound")},toggle:function(a){this.data[a||0].reference.toggle()},bound:function(a){this.data[a||0].reference.bound()},rebound:function(a){this.data[a||0].reference.rebound()},getSectors:function(){return this.sectors},doAnimation:function(a,d,b){var c=0,e=b.oA;b.sectors.each(function(f){c=b.animationArithmetic(a,0,f.get("totalAngle"),d);f.push("startAngle",e);f.push("endAngle",e+c);e+=c;b.is3D()||f.drawSector()});b.is3D()&&b.proxy.drawSector()},localizer:function(a){var d=this.get("layout_distance");this.sectors.each(function(b){if(b.isLabel()){var b=b.label,c=b.labelx,e=b.labely;if(a.labely<=e&&e-a.labely-1<a.get("height")||a.labely>e&&a.labely-e-1<b.get("height"))if(a.labelx<c&&c-a.labelx<a.get("width")||a.labelx>c&&a.labelx-c<b.get("width"))a.push("labely",a.get("labely")+e-a.labely+(a.get("height")+d)*(2==a.get("quadrantd")?-1:1)),a.push("line_points",a.get("line_points").concat({x:a.get("labelx"),y:a.get("labely")})),a.localizer()}},this)},doParse:function(a,d,b){var c=d.name+" "+a.getPercent(d.value);a.doActing(a,d,b,c);a.push("sub_option.id",b);a.push("sub_option.label.text",c);a.push("sub_option.listeners.changed",function(b,c){a.fireEvent(a,c?"bound":"rebound",[a,b.get("name")])});d=this.doSector(d);d.isLabel()&&this.get("intellectLayout")&&this.localizer(d.label);this.sectors.push(d)},doConfig:function(){iChart.Pie.superclass.doConfig.call(this);iChart.Assert.gtZero(this.total,"this.total");var a=this._(),d=a.get("radius"),b=a.get("sub_option.label")?0.35:0.44;a.sectors=[];a.sectors.zIndex=a.get("z_index");a.components.push(a.sectors);a.oA=iChart.angle2Radian(a.get("offset_angle"));a.is3D()&&(b+=0.06);var b=a.get("minDistance")*b,c=a.oA,e=c,f=a.data.length;a.data.each(function(b,d){c+=2*b.value/a.total*Math.PI;d==f-1&&(c=2*Math.PI+a.oA);b.startAngle=e;b.endAngle=c;b.totalAngle=c-e;b.middleAngle=(e+c)/2;e=c},a);if(0>=d||d>b)d=a.push("radius",Math.floor(b));a.r=d;"left"==a.get("align")?a.push("originx",d+a.get("l_originx")+a.get("offsetx")):"right"==a.get("align")?a.push("originx",a.get("r_originx")-d+a.get("offsetx")):a.push("originx",a.get("centerx")+a.get("offsetx"));a.push("originy",a.get("centery")+a.get("offsety"));iChart.apply(a.get("sub_option"),iChart.clone(["originx","originy","bound_event","mutex","increment"],a.options))}});